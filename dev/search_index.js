var documenterSearchIndex = {"docs":
[{"location":"gp/#Gaussian-Process-Regression","page":"Gaussian Process Regression","title":"Gaussian Process Regression","text":"","category":"section"},{"location":"gp/","page":"Gaussian Process Regression","title":"Gaussian Process Regression","text":"gpreg_all_threads(t, beta, st, gpreg, ; nt = 16, bt = 1, n = size(beta, 2))\ngpmodels(t, y, st)\ngpreg(t, y, st, kernel, logσn=log(std(y)))\ngpreg_matern52(t, y, st, kernparams=(1.0, 1.0), logσn=log(std(y)))\ngpreg_const(t, y, st, kernparams=(1.0), logσn=log(std(y)))\ngpreg_linear(t, y, st, kernparams=(1.0, 1.0), logσn=log(std(y)))","category":"page"},{"location":"gp/#GPMethylation.gpreg_all_threads-NTuple{4, Any}","page":"Gaussian Process Regression","title":"GPMethylation.gpreg_all_threads","text":"gpreg_all_threads(t, beta, st, gpreg, ; nt = 16, bt = 1, n = size(beta, 2))\n\nWrapper to run a Gaussian Process regression function gp_reg ∈ {gp_reg_matern52, gp_reg_const, gp_reg_linear} with multiple threads.\n\nKeyword argument nt = 16 specifies number of threads. \n\nAllows balance of threads to run regression on independent probes in parallel vs threads used by BLAS library for parallelising linear algebra used in regression of a single probe.\n\nCurrently, recommend setting BLAS threads bt = 1 and parallelising over multiple probes.\n\n\n\n\n\n","category":"method"},{"location":"gp/#GPMethylation.gpmodels-Tuple{Any, Any, Any}","page":"Gaussian Process Regression","title":"GPMethylation.gpmodels","text":"gpmodels(t, y, st)\n\nRuns GP regression for constant, linear and Matern52 kernels.\n\n\n\n\n\n","category":"method"},{"location":"gp/#GPMethylation.gpreg","page":"Gaussian Process Regression","title":"GPMethylation.gpreg","text":"gpreg(t, y, st, kernel, kernparams=(1.0, 1.0), logNoise=log(std(y)))\n\nGeneric GP stationary zero mean regression with Gaussian likelihood. Params:\n\nt vector of time points (in this case ages)\ny vector of signal values (in this case prob methylation)\nst vector of time points to evaluate GP mean and var\nkernel GP kernel with inital params e.g. Mat52Iso\nlogσn log(σn)\n\nReturns: Named tuple (gp=gp, μ=μ, v=v)\n\n\n\n\n\n","category":"function"},{"location":"gp/#GPMethylation.gpreg_matern52","page":"Gaussian Process Regression","title":"GPMethylation.gpreg_matern52","text":"gpreg_matern52(t, y, st, kernparams=(1.0, 1.0) , log(std(y))))\n\nGP regression with Mat52Iso(ℓ, σf) kernel.\n\nkernparms = (logℓ, log(σf))\n\nℓ  - initial lengthscale\n\nσf - initial function variance\n\n\n\n\n\n","category":"function"},{"location":"gp/#GPMethylation.gpreg_const","page":"Gaussian Process Regression","title":"GPMethylation.gpreg_const","text":"gpreg_const(t, y, st, kernparams=(1.0) , log(std(y))))\n\nGP regression with Const(σf).\n\nkernparms = (log(σf))\n\nσf - initial function variance\n\n\n\n\n\n","category":"function"},{"location":"gp/#GPMethylation.gpreg_linear","page":"Gaussian Process Regression","title":"GPMethylation.gpreg_linear","text":"gpreg_linear(t, y, st, kernparams=(1.0) , log(std(y))))\n\nGP regression with Const(σf) + LinIso(ℓ) kernel.\n\nkernparms = (logℓ, log(σf))\n\nℓ  - initial lengthscale\n\nσf - initial function variance\n\n\n\n\n\n","category":"function"},{"location":"analysis/#Analysing-Data","page":"Analysing Data","title":"Analysing Data","text":"","category":"section"},{"location":"analysis/","page":"Analysing Data","title":"Analysing Data","text":"run_gpregression(samplemetafile, betafile, outdir, m=50; verbose=true)\nsaverdata(probes, samples, GPT, outdir; verbose=true)\ngpstats(probes, GPT, beta)  ","category":"page"},{"location":"analysis/#GPMethylation.run_gpregression","page":"Analysing Data","title":"GPMethylation.run_gpregression","text":"run_gpregression(samplemetafile, betafile, m=50; verbose=true)\n\nRun analysis for model selection between constant, linear or non-linear (Mat52) kernels\n\nInput:\n\nsamplefmetafile - File with sample meta\nbetafile - RData for with probe beta.\noutdir - Directory to store results, with following contents\ngpstats.tsv - Tab separated file with marginal likelihoods and optimised kernel parameters for all kernels\ngpmeanvar.rdata - RData file containing GP mean and variance for each probe\nm = 50 - Number of points to calculate GP mean and variance at between min and max Age.\n\n\n\n\n\n","category":"function"},{"location":"analysis/#GPMethylation.saverdata-NTuple{4, Any}","page":"Analysing Data","title":"GPMethylation.saverdata","text":"saverdata(probes, samples, GPT, outdir; verbose=true)\n\nSave gp mean and var in RData format.\n\n\n\n\n\n","category":"method"},{"location":"analysis/#GPMethylation.gpstats-Tuple{Any, Any, Any}","page":"Analysing Data","title":"GPMethylation.gpstats","text":"gpstats(probes, GPT, beta)\n\nWrites tab-separated file with gp stats.\n\n\n\n\n\n","category":"method"},{"location":"load/#Loading-Data","page":"Loading Data","title":"Loading Data","text":"","category":"section"},{"location":"load/","page":"Loading Data","title":"Loading Data","text":"loaddata(file)\nloadsamplemeta(file)\nloadprobemeta(file)\nloadmeta(file, mandatorycols, label)\nloadall(samplemetafile, betafile)","category":"page"},{"location":"load/#GPMethylation.loaddata-Tuple{Any}","page":"Loading Data","title":"GPMethylation.loaddata","text":"loaddata(file)\n\nLoads methylation data.\n\nfile is a RData file containing a matrix named betas.dasen of size (n x m) for n samples and m probes.\n\nSample names and probe names taken from colnames and rownames respectively.\n\n\n\n\n\n","category":"method"},{"location":"load/#GPMethylation.loadsamplemeta-Tuple{Any}","page":"Loading Data","title":"GPMethylation.loadsamplemeta","text":"loadsamplemeta(file)\n\nLoads sample meta, a tab or commma separated file that must contain the following first threecolumns (in any order):\n\nSample Sex Age Filter\nSample_1 F 1.0 1\nSample_2 M 2.0 0\nSample_3 M 10.0 1\n\nSample unique string identifier\nSex  {M, F} or missing\nAge floating point age\nFilter optional column of {1, 0}s to exclude samples, when Filter = 0 sample is excluded.\n\nSample should match colnames of RData file. \n\n\n\n\n\n","category":"method"},{"location":"load/#GPMethylation.loadprobemeta-Tuple{Any}","page":"Loading Data","title":"GPMethylation.loadprobemeta","text":"loadprobemeta(file)\n\nLoads probe meta, a tab or commma separated file that must contain the following columns (in any order):\n\nProbe\ncg00000029\ncg00000103\ncg00000109\n\nCan be used to override the rownames in RData file.\n\n\n\n\n\n","category":"method"},{"location":"load/#GPMethylation.loadmeta-Tuple{Any, Any, Any}","page":"Loading Data","title":"GPMethylation.loadmeta","text":"loadmeta(file, mandatorycols, label)\n\nHelper function used to load metafiles\n\n\n\n\n\n","category":"method"},{"location":"load/#GPMethylation.loadall-Tuple{Any, Any}","page":"Loading Data","title":"GPMethylation.loadall","text":"loadall(samplemetafile, betafile)\n\nLoads samplefmetafile and RData file betafile ensures samples details correspond and filters samples\n\n\n\n\n\n","category":"method"},{"location":"#Home","page":"Home","title":"Home","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for GPMethylation.jl a package that runs Gaussian process regression and model selection on methylation time series.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Prior to running the package must be installed using Julia package manager","category":"page"},{"location":"","page":"Home","title":"Home","text":"    ] add https://github.com/owensnick/GPMethylation.jl","category":"page"},{"location":"#Running","page":"Home","title":"Running","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Once installed, example script to run analysis given below:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Make a file gpanalysis.jl with the following contents:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using GPMethylation\n\nsamplemetafile = ... # tab separated file describing samples\nbetafile       = ... # RData file describing probe beta values\noutdir         = ... # directory to save results\nm              = 50  # number of points at which to calculate GP mean and var between min and max Age\n\nrun_gpregression(samplemetafile, betafile, outdir, m)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Then at a terminal run","category":"page"},{"location":"","page":"Home","title":"Home","text":"julia -t N gpanalysis.jl","category":"page"},{"location":"","page":"Home","title":"Home","text":"Where N is the number of threads.","category":"page"},{"location":"#Contents","page":"Home","title":"Contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"#Index","page":"Home","title":"Index","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"","category":"page"}]
}
